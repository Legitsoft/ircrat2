//  ██╗     ███████╗ ██████╗ ██╗████████╗███████╗ ██████╗ ███████╗████████╗    ███████╗███████╗ ██████╗██╗   ██╗██████╗ ██╗████████╗██╗   ██╗
//  ██║     ██╔════╝██╔════╝ ██║╚══██╔══╝██╔════╝██╔═══██╗██╔════╝╚══██╔══╝    ██╔════╝██╔════╝██╔════╝██║   ██║██╔══██╗██║╚══██╔══╝╚██╗ ██╔╝
//  ██║     █████╗  ██║  ███╗██║   ██║   ███████╗██║   ██║█████╗     ██║       ███████╗█████╗  ██║     ██║   ██║██████╔╝██║   ██║    ╚████╔╝ 
//  ██║     ██╔══╝  ██║   ██║██║   ██║   ╚════██║██║   ██║██╔══╝     ██║       ╚════██║██╔══╝  ██║     ██║   ██║██╔══██╗██║   ██║     ╚██╔╝  
//  ███████╗███████╗╚██████╔╝██║   ██║   ███████║╚██████╔╝██║        ██║       ███████║███████╗╚██████╗╚██████╔╝██║  ██║██║   ██║      ██║   
//  ╚══════╝╚══════╝ ╚═════╝ ╚═╝   ╚═╝   ╚══════╝ ╚═════╝ ╚═╝        ╚═╝       ╚══════╝╚══════╝ ╚═════╝ ╚═════╝ ╚═╝  ╚═╝╚═╝   ╚═╝      ╚═╝   
//                                                                                                                                           
//  ██╗██████╗  ██████╗██████╗  █████╗ ████████╗    ██████╗     ██████╗ 
//  ██║██╔══██╗██╔════╝██╔══██╗██╔══██╗╚══██╔══╝    ╚════██╗   ██╔═████╗
//  ██║██████╔╝██║     ██████╔╝███████║   ██║        █████╔╝   ██║██╔██║
//  ██║██╔══██╗██║     ██╔══██╗██╔══██║   ██║       ██╔═══╝    ████╔╝██║
//  ██║██║  ██║╚██████╗██║  ██║██║  ██║   ██║       ███████╗██╗╚██████╔╝
//  ╚═╝╚═╝  ╚═╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═╝   ╚═╝       ╚══════╝╚═╝ ╚═════╝ 
//                                                                      
//  Legitsoft 2015

#include <thread>
#include "ircconnection.h"
using namespace std;
IrcConnection conn;

void handler(string msg) {
	cout << msg << endl;
	if (msg.find("376") != string::npos) {
		cout << "FOUND!" << endl;
		conn.join("#legari7");
		conn.sendMessage("PRIVMSG #legari7 :lol\r\n");
	}
}

void initialize() {
	conn = IrcConnection("192.98.101.230", 6667, "legitsoft7", handler, "ircrattest7");
	bool success = conn.connectToServer();
	if (success) {
		conn.read();
	}
}

int main()
{
	thread ircthread(initialize);
	ircthread.join();
	return 0;
}